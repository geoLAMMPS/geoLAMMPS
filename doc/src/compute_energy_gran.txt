"LAMMPS WWW Site"_lws - "LAMMPS Documentation"_ld - "LAMMPS Commands"_lc :c

:link(lws,http://lammps.sandia.gov)
:link(ld,Manual.html)
:link(lc,Commands_all.html)

:line

compute energy/gran command :h3

[Syntax:]

compute ID group-ID energy/gran term_1 term_2 ... :pre

ID, group-ID are documented in "compute"_compute.html command :ulb,l
energy/gran = style name of this compute command :l
input = one or more of the following energy terms: :l
     friction = energy dissipated by friction
     rotational_kinetic = rotational kinetic energy
     translational_kinetic = translational kinetic energy
     kinetic = total kinetic energy
     boundary = total energy added/removed by boundary work
     volumetric = energy added/removed by volumetric work
     distortional = energy added/removed by distortional work
     normal_strain = normal spring contribution to strain energy
     shear_strain = shear spring contribution to strain energy
     strain = total strain energy
     local_damping = energy dissipated by local damping
     viscous_damping = energy dissipated by viscous damping
     damping = total energy dissipated by damping :pre
:ule

[Examples:]

compute 1 all energy/gran translational_kinetic friction kinetic rotational_kinetic normal_strain shear_strain boundary strain damping
compute 1 all energy/gran strain friction kinetic :pre

[Description:]

Define a computation that allows various specified components of
energy to be written out periodically during a simulation. This
compute requires a granular pairstyle to be defined. When {boundary}
and/or {volumetric} and/or {distortional} work terms are listed
among the energy terms, a helper fix, FixEnergyBoundary,
is implicitly created in the code.

Distortional and volumetric work are subdivisions of the total
boundary work. See, for example, Eq. 1.33 (p.21) of 'Soil Behaviour
and Critical State Soil Mechanics' by David Muir Wood (1990).

At present, this compute is applicable to all granular pairstyles and
boundary conditions with one exception. When rigid walls are present 
AND they are moving (an unusual combination), {boundary}, {volumetric}
and {distortional} are not currently 
calculated. If this capability is needed, the framework and all of the
hooks are already present in FixEnergyBoundary so it should be reasonably
easy to add. Strain energy for particle-wall overlaps is seamlessly
integrated with the strain energy for particle-particle overlaps.

The input energy terms can be listed in any order. A term cannot be
duplicated (but there is no reason to do this anyway).

[Output info:]

This compute provides three types of output. Firstly, the specified total
energy terms for the whole system are available to be written to a file
using "fix_print"_fix_print.html. For example:

	compute		2 all energy/gran translational_kinetic friction kinetic normal_strain shear_strain boundary :pre

	variable 	step equal step
	variable	tke equal c_2\[1\]
	variable	friction equal c_2\[2\]
	variable	ke equal c_2\[3\]
	variable	nstr equal c_2\[4\]
	variable	sstr equal c_2\[5\]
	variable	boundary equal c_2\[6\] :pre

	fix 		5 all print 1000 "$\{step\} $\{friction\} $\{boundary\} $\{tke\} $\{ke\} $\{nstr\} $\{sstr\}" file Energy_Terms.txt screen no :pre

It is noted that the order of the variables in "fix_print"_fix_print.html does not
need to correspond to the order in the compute. The second type of
output is a per-atom vector/array of kinetic energies. If one or more
kinetic energy terms ({rotational_kinetic}, {translational_kinetic} or
{kinetic}) are defined in the compute, these can be accessed using 
"dump_custom"_dump.html. The order of the per-particle kinetic energies is the 
same as their order among the compute arguments. In the example shown
above, two kinetic energies are defined: (1) translational_kinetic; 
(2) kinetic. These can be written to dump files using the following
command:

	dump		1 all custom 100000 dump.ke_* c_2\[1\] c_2\[2\] :pre

Finally, per-contact energy terms are available via "dump_local"_dump.html if the
{trace_energy} option of "pair_modify"_pair_modify.html is enabled in the script.
As described
in "Interpreting_ComputePairLocal_Output.doc"_USER/gran/Interpreting_ComputePairLocal_Output.doc, 
the last four slots are 
available for energy components, though the last of these is currently 
unused. Continuing this example, write out the atom tags and three defined
energy components using the following syntax:

        pair_modify     trace_energy
	compute 	1 all pair/local p1 p2 p3 p4 p5 p6 p7 p8 p9 p10 p11 p12 p13 p14 p15 p16 p17 p18
	dump		2 all local 100000 dump.per_contact_energy_* c_1\[5\] c_1\[6\] c_1\[15\] c_1\[16\] c_1\[17\] :pre

A simple input script, in.compute_energy_gran, which demonstrates all of these output 
options and a MATLAB plotting script are provided with the other documentation.

[Restrictions:] A granular pairstyle must be defined.

[Default:] none
