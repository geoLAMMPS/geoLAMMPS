

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>compute energy/gran command &mdash; LAMMPS 15 May 2015 version documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/sphinxcontrib-images/LightBox2/lightbox2/css/lightbox.css" type="text/css" />
  

  
    <link rel="top" title="LAMMPS 15 May 2015 version documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="Manual.html" class="icon icon-home"> LAMMPS
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="Section_intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_start.html">2. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_commands.html">3. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_packages.html">4. Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_accelerate.html">5. Accelerating LAMMPS performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_howto.html">6. How-to discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_example.html">7. Example problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_perf.html">8. Performance &amp; scalability</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_tools.html">9. Additional tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_modify.html">10. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_python.html">11. Python interface to LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_errors.html">12. Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="Section_history.html">13. Future and history</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="Manual.html">LAMMPS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="Manual.html">Docs</a> &raquo;</li>
      
    <li>compute energy/gran command</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="http://lammps.sandia.gov">Website</a>
            <a href="Section_commands.html#comm">Commands</a>
        
      </li>
  </ul>
  <hr/>
  
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="compute-energy-gran-command">
<span id="index-0"></span><h1>compute energy/gran command<a class="headerlink" href="#compute-energy-gran-command" title="Permalink to this headline">¶</a></h1>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">compute</span> <span class="n">ID</span> <span class="n">group</span><span class="o">-</span><span class="n">ID</span> <span class="n">energy</span><span class="o">/</span><span class="n">gran</span> <span class="n">term_1</span> <span class="n">term_2</span> <span class="o">...</span>
</pre></div>
</div>
<ul class="simple">
<li>ID, group-ID are documented in <a class="reference internal" href="compute.html"><span class="doc">compute</span></a> command</li>
<li>energy/gran = style name of this compute command</li>
<li>input = one or more of the following energy terms:</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">friction</span> <span class="o">=</span> <span class="n">energy</span> <span class="n">dissipated</span> <span class="n">by</span> <span class="n">friction</span>
<span class="n">rotational_kinetic</span> <span class="o">=</span> <span class="n">rotational</span> <span class="n">kinetic</span> <span class="n">energy</span>
<span class="n">translational_kinetic</span> <span class="o">=</span> <span class="n">translational</span> <span class="n">kinetic</span> <span class="n">energy</span>
<span class="n">kinetic</span> <span class="o">=</span> <span class="n">total</span> <span class="n">kinetic</span> <span class="n">energy</span>
<span class="n">boundary</span> <span class="o">=</span> <span class="n">total</span> <span class="n">energy</span> <span class="n">added</span><span class="o">/</span><span class="n">removed</span> <span class="n">by</span> <span class="n">boundary</span> <span class="n">work</span>
<span class="n">volumetric</span> <span class="o">=</span> <span class="n">energy</span> <span class="n">added</span><span class="o">/</span><span class="n">removed</span> <span class="n">by</span> <span class="n">volumetric</span> <span class="n">work</span>
<span class="n">distortional</span> <span class="o">=</span> <span class="n">energy</span> <span class="n">added</span><span class="o">/</span><span class="n">removed</span> <span class="n">by</span> <span class="n">distortional</span> <span class="n">work</span>
<span class="n">normal_strain</span> <span class="o">=</span> <span class="n">normal</span> <span class="n">spring</span> <span class="n">contribution</span> <span class="n">to</span> <span class="n">strain</span> <span class="n">energy</span>
<span class="n">shear_strain</span> <span class="o">=</span> <span class="n">shear</span> <span class="n">spring</span> <span class="n">contribution</span> <span class="n">to</span> <span class="n">strain</span> <span class="n">energy</span>
<span class="n">strain</span> <span class="o">=</span> <span class="n">total</span> <span class="n">strain</span> <span class="n">energy</span>
<span class="n">local_damping</span> <span class="o">=</span> <span class="n">energy</span> <span class="n">dissipated</span> <span class="n">by</span> <span class="n">local</span> <span class="n">damping</span>
<span class="n">viscous_damping</span> <span class="o">=</span> <span class="n">energy</span> <span class="n">dissipated</span> <span class="n">by</span> <span class="n">viscous</span> <span class="n">damping</span>
<span class="n">damping</span> <span class="o">=</span> <span class="n">total</span> <span class="n">energy</span> <span class="n">dissipated</span> <span class="n">by</span> <span class="n">damping</span>
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">compute</span> <span class="mi">1</span> <span class="nb">all</span> <span class="n">energy</span><span class="o">/</span><span class="n">gran</span> <span class="n">translational_kinetic</span> <span class="n">friction</span> <span class="n">kinetic</span> <span class="n">rotational_kinetic</span> <span class="n">normal_strain</span> <span class="n">shear_strain</span> <span class="n">boundary</span> <span class="n">strain</span> <span class="n">damping</span>
<span class="n">compute</span> <span class="mi">1</span> <span class="nb">all</span> <span class="n">energy</span><span class="o">/</span><span class="n">gran</span> <span class="n">strain</span> <span class="n">friction</span> <span class="n">kinetic</span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Define a computation that allows various specified components of
energy to be written out periodically during a simulation. This
compute requires a granular pairstyle to be defined. When <em>boundary</em>
and/or <em>volumetric</em> and/or <em>distortional</em> work terms are listed
among the energy terms, a helper fix, FixEnergyBoundary,
is implicitly created in the code.</p>
<p>Distortional and volumetric work are subdivisions of the total
boundary work. See, for example, Eq. 1.33 (p.21) of &#8216;Soil Behaviour
and Critical State Soil Mechanics&#8217; by David Muir Wood (1990).</p>
<p>At present, this compute is applicable to all granular pairstyles and
boundary conditions with one exception. When rigid walls are present
AND they are moving (an unusual combination), <em>boundary</em>, <em>volumetric</em>
and <em>distortional</em> are not currently
calculated. If this capability is needed, the framework and all of the
hooks are already present in FixEnergyBoundary so it should be reasonably
easy to add. Strain energy for particle-wall overlaps is seamlessly
integrated with the strain energy for particle-particle overlaps.</p>
<p>The input energy terms can be listed in any order. A term cannot be
duplicated (but there is no reason to do this anyway).</p>
<p><strong>Output info:</strong></p>
<p>This compute provides three types of output. Firstly, the specified total
energy terms for the whole system are available to be written to a file
using <a class="reference internal" href="fix_print.html"><span class="doc">fix_print</span></a>. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">compute</span>         <span class="mi">2</span> <span class="nb">all</span> <span class="n">energy</span><span class="o">/</span><span class="n">gran</span> <span class="n">translational_kinetic</span> <span class="n">friction</span> <span class="n">kinetic</span> <span class="n">normal_strain</span> <span class="n">shear_strain</span> <span class="n">boundary</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">variable</span>        <span class="n">step</span> <span class="n">equal</span> <span class="n">step</span>
<span class="n">variable</span>        <span class="n">tke</span> <span class="n">equal</span> <span class="n">c_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">variable</span>        <span class="n">friction</span> <span class="n">equal</span> <span class="n">c_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">variable</span>        <span class="n">ke</span> <span class="n">equal</span> <span class="n">c_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">variable</span>        <span class="n">nstr</span> <span class="n">equal</span> <span class="n">c_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">variable</span>        <span class="n">sstr</span> <span class="n">equal</span> <span class="n">c_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="n">variable</span>        <span class="n">boundary</span> <span class="n">equal</span> <span class="n">c_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">fix</span>             <span class="mi">5</span> <span class="nb">all</span> <span class="nb">print</span> <span class="mi">1000</span> <span class="s2">&quot;$</span><span class="si">{step}</span><span class="s2"> $</span><span class="si">{friction}</span><span class="s2"> $</span><span class="si">{boundary}</span><span class="s2"> $</span><span class="si">{tke}</span><span class="s2"> $</span><span class="si">{ke}</span><span class="s2"> $</span><span class="si">{nstr}</span><span class="s2"> $</span><span class="si">{sstr}</span><span class="s2">&quot;</span> <span class="n">file</span> <span class="n">Energy_Terms</span><span class="o">.</span><span class="n">txt</span> <span class="n">screen</span> <span class="n">no</span>
</pre></div>
</div>
<p>It is noted that the order of the variables in <a class="reference internal" href="fix_print.html"><span class="doc">fix_print</span></a> does not
need to correspond to the order in the compute. The second type of
output is a per-atom vector/array of kinetic energies. If one or more
kinetic energy terms (<em>rotational_kinetic</em>, <em>translational_kinetic</em> or
<em>kinetic</em>) are defined in the compute, these can be accessed using
<span class="xref doc">dump_custom</span>. The order of the per-particle kinetic energies is the
same as their order among the compute arguments. In the example shown
above, two kinetic energies are defined: (1) translational_kinetic;
(2) kinetic. These can be written to dump files using the following
command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dump</span>            <span class="mi">1</span> <span class="nb">all</span> <span class="n">custom</span> <span class="mi">100000</span> <span class="n">dump</span><span class="o">.</span><span class="n">ke_</span><span class="o">*</span> <span class="n">c_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">c_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Finally, per-contact energy terms are available via <span class="xref doc">dump_local</span> if the
<em>trace_energy</em> option of <a class="reference internal" href="pair_modify.html"><span class="doc">pair_modify</span></a> is enabled in the script.
As described
in <a class="reference external" href="USER/gran/Interpreting_ComputePairLocal_Output.doc">Interpreting_ComputePairLocal_Output.doc</a>,
the last four slots are
available for energy components, though the last of these is currently
unused. Continuing this example, write out the atom tags and three defined
energy components using the following syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>   <span class="n">pair_modify</span>     <span class="n">trace_energy</span>
<span class="n">compute</span>         <span class="mi">1</span> <span class="nb">all</span> <span class="n">pair</span><span class="o">/</span><span class="n">local</span> <span class="n">p1</span> <span class="n">p2</span> <span class="n">p3</span> <span class="n">p4</span> <span class="n">p5</span> <span class="n">p6</span> <span class="n">p7</span> <span class="n">p8</span> <span class="n">p9</span> <span class="n">p10</span> <span class="n">p11</span> <span class="n">p12</span> <span class="n">p13</span> <span class="n">p14</span> <span class="n">p15</span> <span class="n">p16</span> <span class="n">p17</span> <span class="n">p18</span>
<span class="n">dump</span>            <span class="mi">2</span> <span class="nb">all</span> <span class="n">local</span> <span class="mi">100000</span> <span class="n">dump</span><span class="o">.</span><span class="n">per_contact_energy_</span><span class="o">*</span> <span class="n">c_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">c_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="n">c_1</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="n">c_1</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="n">c_1</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
<p>A simple input script, in.compute_energy_gran, which demonstrates all of these output
options and a MATLAB plotting script are provided with the other documentation.</p>
</div>
<div class="section" id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>A granular pairstyle must be defined.</div></blockquote>
<p><strong>Default:</strong> none</p>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright .
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'15 May 2015 version',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="_static/sphinxcontrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
      <script type="text/javascript" src="_static/sphinxcontrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
      <script type="text/javascript" src="_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
